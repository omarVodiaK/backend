<div class="page-header">
    <h1>Campaign</h1>
</div>

<div class="container" style="width: 100%">
    <div class="row" style="margin-top:20px;">

        <div class="col-md-6">
            <form class="form-inline">
                <div class="form-group">
                    <label>Search: </label>
                    <input type="text" ng-model="search" class="form-control" placeholder="keyword">
                </div>
            </form>
        </div>

        <div class="col-md-6">
            <div class="pull-right">
                <button type="button" onclick="window.location.href='#/dashboard/new-campaign'" class="btn btn-primary">
                    New Campaign
                </button>
            </div>
        </div>

    </div>
</div>

<div id="level1" style="margin-top:20px;">
    <div id="level2" class="table-responsive" ng-controller="CampaignAlertCtrl">

        <table class="table table-striped table-hover" ng-controller="PublishCampaignModal">
            <thead>
            <tr>
                <th></th>
                <th>Name</th>
                <th>Start from</th>
                <th>Finish at</th>
                <th>State</th>
                <th>Priority</th>
                <th></th>
            </tr>
            </thead>
            <tbody dir-paginate="campaign in campaigns | filter:search | itemsPerPage:5">
            <tr>
                <td></td>
                <td>{{campaign.camp_name}}</td>
                <td ng-repeat="sch in campaign.schedule">{{sch.sch_start}}</td>
                <td ng-repeat="sch in campaign.schedule">{{sch.sch_end}}</td>
                <td>
                    <statedirective data="campaign"></statedirective>
                </td>
                <td>
                    {{campaign.camp_priority}}

                </td>
                <td class="text-right">

                    <div class="btn-group" role="group">

                        <button ng-click="confirmCancel(campaign.camp_state)"
                                ng-class="{false: 'btn btn-success', true: 'btn btn-default'} [campaign.camp_state == 'activated']">
                            <i class="glyphicon glyphicon-share-alt visible-xs-inline-block"></i>
                            <span class="hidden-xs hidden-md">{{campaign.camp_state == "activated" ? 'Deactivate' : 'Activate'}}</span>
                        </button>

                        <button class="btn btn-danger" ng-click="removeCampaignRow(campaign._id)">
                            <i class="glyphicon glyphicon-remove visible-xs-inline-block"></i>
                            <span class="hidden-xs  hidden-md">Remove</span>
                        </button>

                        <button ng-click="updateCampaign(campaign)" class="btn btn-warning">
                            <i class="glyphicon glyphicon-pencil visible-xs-inline-block"></i>
                            <span class="hidden-xs  hidden-md">Update</span>
                        </button>


                        <script type="text/ng-template" id="publishModalContent.html">

                            <div class="modal-header">
                                <h3 class="modal-title">Publish To</h3>
                            </div>

                            <div class="modal-body">

                                <div class="table-responsive">

                                    <table class="table table-responsive table-striped table-hover"
                                           data-show-refresh="true">

                                        <thead>

                                        <th>name</th>
                                        <th>email</th>
                                        <th></th>

                                        </thead>

                                        <tbody>

                                        <tr dir-paginate="associate in associates |itemsPerPage:5">

                                            <td>
                                                {{associate.name}}
                                            </td>

                                            <td>
                                                {{associate.email}}
                                            </td>

                                            <td class="text-right">
                                                <sharedirective company="associate"
                                                                campaign="campaign"></sharedirective>
                                            </td>

                                        </tr>

                                        </tbody>

                                    </table>

                                </div>

                            </div>
                            <div class="modal-footer">
                                <div class="btn-group">
                                    <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button>
                                    <button class="btn btn-primary" type="button" ng-click="ok()">Done</button>
                                </div>
                            </div>
                        </script>

                        <button class="btn btn-default"
                                ng-click="openModal('lg', 'publishModalContent.html', associates, campaign)">
                            <i class="glyphicon glyphicon-phone visible-xs-inline-block"></i>
                            <span class="hidden-xs  hidden-md">Publish</span>
                        </button>

                    </div>
                </td>
            </tr>
            </tbody>
        </table>

    </div>
</div>

<dir-pagination-controls
        max-size="5"
        direction-links="true"
        boundary-links="true">
</dir-pagination-controls>


<link rel="stylesheet" type="text/css" href="assets/css/component.css"/>

<script>
    var url = "assets/js/classie.js";
    $.getScript(url);
</script>

<script>
    var buttons7Click = Array.prototype.slice.call(document.querySelectorAll('#btn-click button')),
            totalButtons7Click = buttons7Click.length;

    buttons7Click.forEach(function (el, i) {
        el.addEventListener('click', activate, false);
    });


    function activate() {
        var self = this, activatedClass = 'btn-activated';

        if (!classie.has(this, activatedClass)) {
            classie.add(this, activatedClass);
            setTimeout(function () {
                classie.remove(self, activatedClass)
            }, 1000);
        }
    }

</script>
